<html>

<head>
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
</head>

<body>
    <h2>
        Qt 파일 버전 업데이트 테스트
    </h2>
    <div style="border: 1px solid lightgray;">
    <br />
        <설명><br />
        - motif 파일을 업로드합니다. (파일명은 무조건 motif 입니다.) <br />
        - 파일이 제대로 업로드되었는지 확인하고 싶을 때 "motif 파일 존재 확인" 버튼을 클릭하여 확인합니다.<br />
        - 새로운 motif 파일을 업로드하고 싶을 때 "motif 파일 삭제" 버튼을 클릭하여 삭제합니다. (motif 파일을 새로 업로드했을 때 파일명이 같으면 덮어쓰기가 되기는 합니다.)<br />
    <br />
    </div>
    <br />
    <br />
    <div>
        <input type="file" id="FileInput" />
        <hr />
        <button onclick="upload()">
            업로드
        </button>
        <button onclick="remove()">
            motif 파일 삭제
        </button>
        <button onclick="checkExist()">
            motif 파일 존재 확인
        </button>
        <hr />
        <p id="resultUploadPath"></p>
    </div>
</body>

<script>
    const domain = "https://api.motifme.io";

    function upload() {
        const fileInput = $("#FileInput")[0];

        if (fileInput.files.length === 0) {
            alert("파일을 선택해주세요");
            return;
        }

        const formData = new FormData();
        formData.append("motif_file", fileInput.files[0]);

        $.ajax({
            type: "POST",
            url: domain + '/qt_version/test',
            processData: false,
            contentType: false,
            data: formData
        }).done(function (result, textStatus, xhr) {
            if (result.status == 200) {
                alert(result.message);
            } else {
                alert(result.message);
            }
        }).fail(function (result, textStatus, errorThrown) {
            if (result.status == 403) {
                alert(result.responseJSON.message);
            } else {
                alert("전송 실패");
            }
        });
    }

    function remove() {
        $.ajax({
            type: "DELETE",
            url: domain + '/qt_version/test'
        }).done(function (result, textStatus, xhr) {
            if (result.status == 200) {
                alert(result.message);
            } else {
                alert(result.message);
            }
        }).fail(function (result, textStatus, errorThrown) {
            if (result.status == 403) {
                alert(result.responseJSON.message);
            } else {
                alert("전송 실패");
            }
        });
    }

    function checkExist() {
        $.ajax({
            type: "GET",
            url: domain + '/qt_version/test/exist'
        }).done(function (result, textStatus, xhr) {
            if (result.status == 200) {
                alert(result.message);
            } else {
                alert(result.message);
            }
        }).fail(function (result, textStatus, errorThrown) {
            if (result.status == 403) {
                alert(result.responseJSON.message);
            } else {
                alert("전송 실패");
            }
        });
    }
</script>

</html>